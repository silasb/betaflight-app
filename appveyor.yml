version: "{build}"

clone_folder: c:\gopath\src\github.com\golang\dep

environment:
  GOPATH: c:\gopath
  DEPTESTBYPASS501: 1

# environment:
#   global:
#     STACK_ROOT: "c:\\sr"

cache:
  - c:\gopath -> go.mod
  - node_modules
  - C:\Users\appveyor\AppData\Local\Temp\mingw\5.3.0\x86_64-5.3.0-release-posix-seh-rt_v4-rev0.7z

# scripts that run after cloning repository
install:
  - cinst mingw
  - set PATH=%GOPATH%\bin;c:\go\bin;C:\tools\mingw64\bin;%PATH%
  - gcc -v
  - go version
  - go env
  - go get -u golang.org/x/vgo
  - go get -u -u github.com/jteeuwen/go-bindata/...
  - vgo list -m
  - npm install -g yarn
  - yarn install

build_script:
  - yarn version:windows:amd64

artifacts:
  - path: dist/*
    name: Build

# to disable automatic tests
test: off

# to disable deployment
deploy: off